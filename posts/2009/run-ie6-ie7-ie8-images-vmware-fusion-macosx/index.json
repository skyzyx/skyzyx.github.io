{
    "data": {
    "kind": "page",
    "title": "Run Internet Explorer 6 (or IE7, or IE8) images in VMware Fusion on Mac OS X",
    "description": "",
    "summary": {
        "content": "By now, most front-end web developers have heard of the Standalone Internet Explorers (Wikipedia article). Although these are incredibly useful, they’ve always been hacky at best. Because of that, we need to go the long way. We’ll download the “officially sanctioned” VirtualPC images containing a time-limited version of Windows XP SP3 and Internet Explorer 6.0, and then we’ll convert these images to the kind that work with VMware Fusion (which works on Mac OS X). This should only need to be done every 3 or 4 months when the images expire.",
        "isTruncated": true
    },
    "published": "2009-01-07T20:33:34Z",
    "updated": "2019-02-10T21:35:12-08:00",
    "permalink": "https://ryanparman.com/posts/2009/run-ie6-ie7-ie8-images-vmware-fusion-macosx/",
    "relativePermalink": "/posts/2009/run-ie6-ie7-ie8-images-vmware-fusion-macosx/",
    "aliases": ["/2009/01/07/run-ie6-ie7-ie8-images-vmware-fusion-macosx/"],
    "images": [],
    "videos": [],
    "categories": ["Software"],
    "tags": [],
    "series": [],
    "keywords": [],
    "meta": {
        "wordCount": 744,
        "readingTime": "4 minutes",
        "language": "en",
        "isDraft": false,
        "isHome": false,
        "isNode": false,
        "isPage": true,
        "isTranslated": false
    },
    "sourceFile": {
        "path": "posts/2009/20090107-run-ie6-ie7-ie8-images-vmware-fusion-macosx.md",
        "logicalName": "20090107-run-ie6-ie7-ie8-images-vmware-fusion-macosx.md",
        "translationBaseName": "20090107-run-ie6-ie7-ie8-images-vmware-fusion-macosx",
        "baseFileName": "20090107-run-ie6-ie7-ie8-images-vmware-fusion-macosx",
        "ext": "md",
        "lang": "en",
        "dir": "posts/2009/"
    },
    "content": {
        "tableOfContents": "\u003cnav id=\"TableOfContents\"\u003e\n  \u003cul\u003e\n    \u003cli\u003e\u003ca href=\"#prerequisites\"\u003ePrerequisites\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#installing-qemu-first-time-only\"\u003eInstalling Qemu (FIRST-TIME ONLY)\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#downloading-and-preparing-stuff\"\u003eDownloading and Preparing stuff\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#converting-the-image\"\u003eConverting the image\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#configuring-the-vm\"\u003eConfiguring the VM\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"#installing-the-drivers-and-vmware-tools\"\u003eInstalling the drivers and VMWare Tools\u003c/a\u003e\u003c/li\u003e\n  \u003c/ul\u003e\n\u003c/nav\u003e",
        "html":"\u003cp itemprop=\"description\" class=\"f5 f4-m f3-l mt0 lh-copy p-summary entry-summary\"\u003e\nBy now, most front-end web developers have heard of the \u003ca href=\"/2003/11/06/multiple-versions-of-internet-explorer/\"\u003eStandalone Internet Explorers\u003c/a\u003e (\u003ca href=\"https://web.archive.org/web/20090107203334/http://en.wikipedia.org/wiki/Internet_Explorer#.22Standalone.22_Internet_Explorer\"\u003eWikipedia article\u003c/a\u003e). Although these are incredibly useful, they’ve always been hacky at best.\n\u003c/p\u003e\n\n\u003cp\u003eBecause of that, we need to go the long way. We’ll download the “officially sanctioned” VirtualPC images containing a time-limited version of Windows XP SP3 and Internet Explorer 6.0, and then we’ll convert these images to the kind that work with VMware Fusion (which works on Mac OS X). This should only need to be done every 3 or 4 months when the images expire. These instructions are loosely based on the ones found at \u003ca href=\"https://web.archive.org/web/20090107203334/http://blog.mozmonkey.com/2008/vpc-ie6-ie7-ie8-on-mac-os-x/\"\u003eRunning IE6, IE7 and IE8 on your Mac\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate:\u003c/strong\u003e Microsoft’s images are broken, and don’t work on anything except VirtualPC now. Mac and Linux users are out of luck for the time being. More information on the subject can be found at \u003ca href=\"https://web.archive.org/web/20090107203334/http://petelepage.com/blog/2009/09/running-the-ie-vpcs-on-other-vpc-hosts/\"\u003eRunning The IE VPC’s on other VPC Hosts?\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\"\u003ePrerequisites\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eYou need to have \u003ca href=\"https://web.archive.org/web/20090107203334/http://vmware.com/products/fusion/\"\u003eVMware Fusion\u003c/a\u003e installed on your Mac.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou need to have access to a Windows XP machine, as this is where the converting will happen.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"installing-qemu-first-time-only\"\u003eInstalling Qemu (FIRST-TIME ONLY)\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eDownload a small application to our Windows machine called \u003ca href=\"https://web.archive.org/web/20090107203334/http://lassauge.free.fr/qemu/\"\u003eQemu\u003c/a\u003e. At the time of this writing, you want to download the \u003ca href=\"https://web.archive.org/web/20090107203334/http://lassauge.free.fr/qemu/release/Qemu-0.9.1-windows.zip\"\u003eregular version 0.9.1\u003c/a\u003e. Once it’s done, unzip it someplace that’s easy to get to via the command line (e.g., \u003ccode\u003ec:\\qemu\u003c/code\u003e).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGo into the Qemu folder, then into the \u003ccode\u003ebin\u003c/code\u003e folder and copy all of the files in the \u003ccode\u003ebin\u003c/code\u003e folder back to the original Qemu folder (you can simply copy-paste).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"downloading-and-preparing-stuff\"\u003eDownloading and Preparing stuff\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eOn Microsoft’s website, they have a page entitled \u003ca href=\"https://web.archive.org/web/20090107203334/http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF\u0026amp;displaylang=en\"\u003eInternet Explorer Application Compatibility VPC Image\u003c/a\u003e where you can download various time-limited images that allow you to test combinations of Windows XP SP3 or Vista, along with Internet Explorer 6.0, 7.0, and the 8.0 betas. In this example, we’re going to install the IE6/XP image but you can do whatever you need to do.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWe’ll need to unpack this download in Windows, so if you haven’t already, make sure you’re doing this part in Windows.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDouble-click it (in Windows) to begin unpacking it. It will warn you that it has an expiration date. On that date, we’ll have to download a fresh VPC image from Microsoft and do this all over again.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"converting-the-image\"\u003eConverting the image\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eYou’ll want to copy the \u003ccode\u003eXP SP3 with IE6.vhd\u003c/code\u003e file into the Qemu folder. This will allow us to use simpler, more consistent commands to convert the image.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn your Windows VM go to \u003cem\u003eStart Menu\u003c/em\u003e → \u003cem\u003eRun\u003c/em\u003e, type the \u003ccode\u003ecmd\u003c/code\u003e command, and click OK.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUsing your deftly intimate knowledge of MS-DOS, use commands like \u003ccode\u003ecd\u003c/code\u003e to navigate to where you unpacked Qemu.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf you don’t know MS-DOS commands from a hole in the wall, you can download \u003ca href=\"https://cdn.ryanparman.com/wp-content/uploads/2009/01/CmdHerePowertoySetup.exe\"\u003eOpen Command Window Here\u003c/a\u003e from Microsoft, install it, find the Qemu folder in the normal Windows Explorer, right-click, and choose “Open Command Window Here”. One method is shorter and harder, while the other is easier and slower. Take your pick.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eType the following command in your MS-DOS window:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003eqemu-img.exe convert -f vpc \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;XP SP3 with IE6.vhd\u0026#34;\u003c/span\u003e -O vmdk IE6-XP.vmdk\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that \u003ccode\u003eXP SP3 with IE6.vhd\u003c/code\u003e is the path to the IE6 VPC file you downloaded, while \u003ccode\u003eIE6-XP.vmdk\u003c/code\u003e is the new file that VMWare Fusion will use.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWait. This will probably take 5–10 minutes.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"configuring-the-vm\"\u003eConfiguring the VM\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eMove the new \u003ccode\u003e.vmdk\u003c/code\u003e file to your Mac.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOpen VMWare Fusion (or shutdown the Windows VM you may already have running) and click \u003cem\u003eFile\u003c/em\u003e → \u003cem\u003eNew\u003c/em\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGo through the wizard and when you get to the “Virtual Hard Disk” page, expand “Advanced disk options”, check “Use an existing virtual disk” and use the dropdown to find the new \u003ccode\u003e.vmdk\u003c/code\u003e image you just copied back to your Mac.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFinish the wizard and start it! If prompted to upgrade the virtual hard drive, click “Yes.”\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"installing-the-drivers-and-vmware-tools\"\u003eInstalling the drivers and VMWare Tools\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eWith VMWare Fusion running, download and decompress \u003ca href=\"https://cdn.ryanparman.com/wp-content/uploads/2009/01/vmware_xpsp3_drivers.tar.gz\"\u003evmware_xpsp3_drivers.tar.gz\u003c/a\u003e. Copy all of the resulting files to \u003ccode\u003ec:\\windows\\system32\\drivers\u003c/code\u003e. \u003cem\u003eMake sure you install these BEFORE the VMware tools!\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDownload \u003ca href=\"http://cdn.ryanparman.com/vmware_mouse.reg\"\u003evmware_mouse.reg\u003c/a\u003e and double-click it to load its settings into the Windows registry. \u003cem\u003eVMware doesn’t correctly overwrite these setting upon install of the VMware tools, and the mouse can start doing wonky things. These registry settings fix it.\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn VMware, click \u003cem\u003eVirtual Machine\u003c/em\u003e → \u003cem\u003eInstall VMWare Tools\u003c/em\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFollow the instructions. If Windows asks for additional drivers, point it to \u003ccode\u003ec:\\windows\\system32\\drivers\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMake sure that you shutdown the VM and configure your memory (etc.) settings appropriately.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n",
        "plain":"By now, most front-end web developers have heard of the Standalone Internet Explorers (Wikipedia article). Although these are incredibly useful, they’ve always been hacky at best. Because of that, we need to go the long way. We’ll download the “officially sanctioned” VirtualPC images containing a time-limited version of Windows XP SP3 and Internet Explorer 6.0, and then we’ll convert these images to the kind that work with VMware Fusion (which works on Mac OS X). This should only need to be done every 3 or 4 months when the images expire. These instructions are loosely based on the ones found at Running IE6, IE7 and IE8 on your Mac.\nUpdate: Microsoft’s images are broken, and don’t work on anything except VirtualPC now. Mac and Linux users are out of luck for the time being. More information on the subject can be found at Running The IE VPC’s on other VPC Hosts?.\nPrerequisites   You need to have VMware Fusion installed on your Mac.\n  You need to have access to a Windows XP machine, as this is where the converting will happen.\n  Installing Qemu (FIRST-TIME ONLY)   Download a small application to our Windows machine called Qemu. At the time of this writing, you want to download the regular version 0.9.1. Once it’s done, unzip it someplace that’s easy to get to via the command line (e.g., c:\\qemu).\n  Go into the Qemu folder, then into the bin folder and copy all of the files in the bin folder back to the original Qemu folder (you can simply copy-paste).\n  Downloading and Preparing stuff   On Microsoft’s website, they have a page entitled Internet Explorer Application Compatibility VPC Image where you can download various time-limited images that allow you to test combinations of Windows XP SP3 or Vista, along with Internet Explorer 6.0, 7.0, and the 8.0 betas. In this example, we’re going to install the IE6/XP image but you can do whatever you need to do.\n  We’ll need to unpack this download in Windows, so if you haven’t already, make sure you’re doing this part in Windows.\n  Double-click it (in Windows) to begin unpacking it. It will warn you that it has an expiration date. On that date, we’ll have to download a fresh VPC image from Microsoft and do this all over again.\n  Converting the image   You’ll want to copy the XP SP3 with IE6.vhd file into the Qemu folder. This will allow us to use simpler, more consistent commands to convert the image.\n  In your Windows VM go to Start Menu → Run, type the cmd command, and click OK.\n  Using your deftly intimate knowledge of MS-DOS, use commands like cd to navigate to where you unpacked Qemu.\n  If you don’t know MS-DOS commands from a hole in the wall, you can download Open Command Window Here from Microsoft, install it, find the Qemu folder in the normal Windows Explorer, right-click, and choose “Open Command Window Here”. One method is shorter and harder, while the other is easier and slower. Take your pick.\n  Type the following command in your MS-DOS window:\nqemu-img.exe convert -f vpc \u0026#34;XP SP3 with IE6.vhd\u0026#34; -O vmdk IE6-XP.vmdk Note that XP SP3 with IE6.vhd is the path to the IE6 VPC file you downloaded, while IE6-XP.vmdk is the new file that VMWare Fusion will use.\n  Wait. This will probably take 5–10 minutes.\n  Configuring the VM   Move the new .vmdk file to your Mac.\n  Open VMWare Fusion (or shutdown the Windows VM you may already have running) and click File → New.\n  Go through the wizard and when you get to the “Virtual Hard Disk” page, expand “Advanced disk options”, check “Use an existing virtual disk” and use the dropdown to find the new .vmdk image you just copied back to your Mac.\n  Finish the wizard and start it! If prompted to upgrade the virtual hard drive, click “Yes.”\n  Installing the drivers and VMWare Tools   With VMWare Fusion running, download and decompress vmware_xpsp3_drivers.tar.gz. Copy all of the resulting files to c:\\windows\\system32\\drivers. Make sure you install these BEFORE the VMware tools!\n  Download vmware_mouse.reg and double-click it to load its settings into the Windows registry. VMware doesn’t correctly overwrite these setting upon install of the VMware tools, and the mouse can start doing wonky things. These registry settings fix it.\n  In VMware, click Virtual Machine → Install VMWare Tools.\n  Follow the instructions. If Windows asks for additional drivers, point it to c:\\windows\\system32\\drivers.\n  Make sure that you shutdown the VM and configure your memory (etc.) settings appropriately.\n  ",
        "source":"\n{{\u003cdescription\u003e}}\nBy now, most front-end web developers have heard of the \u003ca href=\"/2003/11/06/multiple-versions-of-internet-explorer/\"\u003eStandalone Internet Explorers\u003c/a\u003e (\u003ca href=\"https://web.archive.org/web/20090107203334/http://en.wikipedia.org/wiki/Internet_Explorer#.22Standalone.22_Internet_Explorer\"\u003eWikipedia article\u003c/a\u003e). Although these are incredibly useful, they’ve always been hacky at best.\n{{\u003c/description\u003e}}\n\nBecause of that, we need to go the long way. We’ll download the “officially sanctioned” VirtualPC images containing a time-limited version of Windows XP SP3 and Internet Explorer 6.0, and then we’ll convert these images to the kind that work with VMware Fusion (which works on Mac OS X). This should only need to be done every 3 or 4 months when the images expire. These instructions are loosely based on the ones found at [Running IE6, IE7 and IE8 on your Mac]({{% wayback \"http://blog.mozmonkey.com/2008/vpc-ie6-ie7-ie8-on-mac-os-x/\" %}}).\n\n**Update:** Microsoft’s images are broken, and don’t work on anything except VirtualPC now. Mac and Linux users are out of luck for the time being. More information on the subject can be found at [Running The IE VPC’s on other VPC Hosts?]({{% wayback \"http://petelepage.com/blog/2009/09/running-the-ie-vpcs-on-other-vpc-hosts/\" %}}).\n\n## Prerequisites\n\n* You need to have [VMware Fusion]({{% wayback \"http://vmware.com/products/fusion/\" %}}) installed on your Mac.\n\n* You need to have access to a Windows XP machine, as this is where the converting will happen.\n\n## Installing Qemu (FIRST-TIME ONLY)\n\n1. Download a small application to our Windows machine called [Qemu]({{% wayback \"http://lassauge.free.fr/qemu/\" %}}). At the time of this writing, you want to download the [regular version 0.9.1]({{% wayback \"http://lassauge.free.fr/qemu/release/Qemu-0.9.1-windows.zip\" %}}). Once it’s done, unzip it someplace that’s easy to get to via the command line (e.g., `c:\\qemu`).\n\n2. Go into the Qemu folder, then into the `bin` folder and copy all of the files in the `bin` folder back to the original Qemu folder (you can simply copy-paste).\n\n## Downloading and Preparing stuff\n\n1. On Microsoft’s website, they have a page entitled [Internet Explorer Application Compatibility VPC Image]({{% wayback \"http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF\u0026displaylang=en\" %}}) where you can download various time-limited images that allow you to test combinations of Windows XP SP3 or Vista, along with Internet Explorer 6.0, 7.0, and the 8.0 betas. In this example, we’re going to install the IE6/XP image but you can do whatever you need to do.\n\n2. We’ll need to unpack this download in Windows, so if you haven’t already, make sure you’re doing this part in Windows.\n\n3. Double-click it (in Windows) to begin unpacking it. It will warn you that it has an expiration date. On that date, we’ll have to download a fresh VPC image from Microsoft and do this all over again.\n\n## Converting the image\n\n1. You’ll want to copy the `XP SP3 with IE6.vhd` file into the Qemu folder. This will allow us to use simpler, more consistent commands to convert the image.\n\n2. In your Windows VM go to _Start Menu_ → _Run_, type the `cmd` command, and click OK.\n\n3. Using your deftly intimate knowledge of MS-DOS, use commands like `cd` to navigate to where you unpacked Qemu.\n\n4. If you don’t know MS-DOS commands from a hole in the wall, you can download [Open Command Window Here](https://cdn.ryanparman.com/wp-content/uploads/2009/01/CmdHerePowertoySetup.exe) from Microsoft, install it, find the Qemu folder in the normal Windows Explorer, right-click, and choose “Open Command Window Here”. One method is shorter and harder, while the other is easier and slower. Take your pick.\n\n5. Type the following command in your MS-DOS window:\n\n    ```bash\n    qemu-img.exe convert -f vpc \"XP SP3 with IE6.vhd\" -O vmdk IE6-XP.vmdk\n    ```\n\n    Note that `XP SP3 with IE6.vhd` is the path to the IE6 VPC file you downloaded, while `IE6-XP.vmdk` is the new file that VMWare Fusion will use.\n\n6. Wait. This will probably take 5–10 minutes.\n\n## Configuring the VM\n\n1. Move the new `.vmdk` file to your Mac.\n\n2. Open VMWare Fusion (or shutdown the Windows VM you may already have running) and click _File_ → _New_.\n\n3. Go through the wizard and when you get to the “Virtual Hard Disk” page, expand “Advanced disk options”, check “Use an existing virtual disk” and use the dropdown to find the new `.vmdk` image you just copied back to your Mac.\n\n4. Finish the wizard and start it! If prompted to upgrade the virtual hard drive, click “Yes.”\n\n## Installing the drivers and VMWare Tools\n\n1. With VMWare Fusion running, download and decompress [vmware_xpsp3_drivers.tar.gz](https://cdn.ryanparman.com/wp-content/uploads/2009/01/vmware_xpsp3_drivers.tar.gz). Copy all of the resulting files to `c:\\windows\\system32\\drivers`. *Make sure you install these BEFORE the VMware tools!*\n\n2. Download [vmware_mouse.reg](http://cdn.ryanparman.com/vmware_mouse.reg) and double-click it to load its settings into the Windows registry. *VMware doesn’t correctly overwrite these setting upon install of the VMware tools, and the mouse can start doing wonky things. These registry settings fix it.*\n\n3. In VMware, click _Virtual Machine_ → _Install VMWare Tools_.\n\n4. Follow the instructions. If Windows asks for additional drivers, point it to `c:\\windows\\system32\\drivers`.\n\n5. Make sure that you shutdown the VM and configure your memory (etc.) settings appropriately.\n"},
    "links": {
        "prev": {"title": "Tarzan 2.0 is finally here!", "permalink": "https://ryanparman.com/posts/2008/tarzan-20-is-finally-here/"},
        "next": {"title": "Introducing DOMBuilder", "permalink": "https://ryanparman.com/posts/2009/introducing-dombuilder/"},
        "ignore": "me"
    }
}

}
